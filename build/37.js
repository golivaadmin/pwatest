webpackJsonp([37],{434:function(l,n,e){"use strict";function t(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,40,"ion-grid",[["class","grid"]],null,null,null,null,null)),s["ɵdid"](1,16384,null,0,L.a,[],null,null),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵeld"](3,0,null,null,36,"ion-row",[["class","row"]],null,null,null,null,null)),s["ɵdid"](4,16384,null,0,V.a,[],null,null),(l()(),s["ɵted"](-1,null,["\n\n            "])),(l()(),s["ɵeld"](6,0,null,null,10,"ion-col",[["class","col"]],null,null,null,null,null)),s["ɵdid"](7,16384,null,0,F.a,[],null,null),(l()(),s["ɵted"](-1,null,["\n                "])),(l()(),s["ɵeld"](9,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Personas en espera"])),(l()(),s["ɵted"](-1,null,["\n                "])),(l()(),s["ɵeld"](12,0,null,null,3,"ion-icon",[["name","ios-people-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),s["ɵdid"](13,147456,null,0,D.a,[S.a,s.ElementRef,s.Renderer],{name:[0,"name"]},null),(l()(),s["ɵeld"](14,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),s["ɵted"](15,null,["",""])),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵted"](-1,null,["\n\n            "])),(l()(),s["ɵeld"](18,0,null,null,8,"ion-col",[["class","col"]],null,null,null,null,null)),s["ɵdid"](19,16384,null,0,F.a,[],null,null),(l()(),s["ɵted"](-1,null,["\n                "])),(l()(),s["ɵeld"](21,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Atendiendo al número"])),(l()(),s["ɵted"](-1,null,["\n                "])),(l()(),s["ɵeld"](24,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),s["ɵted"](25,null,["",""])),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵted"](-1,null,["\n\n            "])),(l()(),s["ɵeld"](28,0,null,null,10,"ion-col",[["class","col"]],null,null,null,null,null)),s["ɵdid"](29,16384,null,0,F.a,[],null,null),(l()(),s["ɵted"](-1,null,["\n                "])),(l()(),s["ɵeld"](31,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Tiempo de espera estimado"])),(l()(),s["ɵted"](-1,null,["\n                "])),(l()(),s["ɵeld"](34,0,null,null,3,"ion-icon",[["name","ios-stopwatch-outline"],["role","img"]],[[2,"hide",null]],null,null,null,null)),s["ɵdid"](35,147456,null,0,D.a,[S.a,s.ElementRef,s.Renderer],{name:[0,"name"]},null),(l()(),s["ɵeld"](36,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),s["ɵted"](37,null,[" "," min."])),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵted"](-1,null,["\n\n        "])),(l()(),s["ɵted"](-1,null,["\n    "]))],function(l,n){l(n,13,0,"ios-people-outline");l(n,35,0,"ios-stopwatch-outline")},function(l,n){var e=n.component;l(n,12,0,s["ɵnov"](n,13)._hidden);l(n,15,0,e.data.pef);l(n,25,0,e.data.numero);l(n,34,0,s["ɵnov"](n,35)._hidden);l(n,37,0,e.calcTime(e.data))})}function u(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Tira del ticket hacia abajo"]))],null,null)}function i(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,24,"div",[["class","middle"]],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵeld"](2,0,null,null,16,"div",[],null,[[null,"click"],[null,"pan"]],function(l,n,e){var t=!0,u=l.component;if("click"===n){t=!1!==u.obtenerNumero()&&t}if("pan"===n){t=!1!==u.obtenerNumero()&&t}return t},null,null)),s["ɵdid"](3,278528,null,0,W.j,[s.IterableDiffers,s.KeyValueDiffers,s.ElementRef,s.Renderer2],{ngClass:[0,"ngClass"]},null),s["ɵpod"](4,{ticketOK:0}),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵeld"](6,0,null,null,3,"h4",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Obtener\n                "])),(l()(),s["ɵeld"](8,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["número"])),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵeld"](11,0,null,null,3,"h5",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Tu número de\n                "])),(l()(),s["ɵeld"](13,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["atención es el"])),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵeld"](16,0,null,null,1,"h3",[],null,null,null,null,null)),(l()(),s["ɵted"](17,null,["",""])),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵeld"](20,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵand"](16777216,null,null,1,null,u)),s["ɵdid"](23,16384,null,0,W.l,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](-1,null,["\n    "]))],function(l,n){var e=n.component;l(n,3,0,l(n,4,0,e.isOK));l(n,23,0,0==e.isOK)},function(l,n){l(n,17,0,n.component.numeroActual)})}function o(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Tira del ticket hacia abajo"]))],null,null)}function r(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,2,"button",[["ion-button",""],["red-outline",""]],null,[[null,"click"]],function(l,n,e){var t=!0;if("click"===n){t=!1!==l.component.cancelarNumero()&&t}return t},x.b,x.a)),s["ɵdid"](1,1097728,null,0,J.a,[[8,""],S.a,s.ElementRef,s.Renderer],null,null),(l()(),s["ɵted"](-1,0,["Anular Turno"]))],null,null)}function a(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,22,"div",[["class","middle"]],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵeld"](2,0,null,null,11,"div",[],null,null,null,null,null)),s["ɵdid"](3,278528,null,0,W.j,[s.IterableDiffers,s.KeyValueDiffers,s.ElementRef,s.Renderer2],{ngClass:[0,"ngClass"]},null),s["ɵpod"](4,{ticketOK:0}),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵeld"](6,0,null,null,3,"h5",[["class","numeroAtencion"]],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["Tu número de\n                "])),(l()(),s["ɵeld"](8,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["atención es el"])),(l()(),s["ɵted"](-1,null,["\n            "])),(l()(),s["ɵeld"](11,0,null,null,1,"h3",[],null,null,null,null,null)),(l()(),s["ɵted"](12,null,["",""])),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵeld"](15,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵand"](16777216,null,null,1,null,o)),s["ɵdid"](18,16384,null,0,W.l,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](-1,null,["\n        "])),(l()(),s["ɵand"](16777216,null,null,1,null,r)),s["ɵdid"](21,16384,null,0,W.l,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](-1,null,["\n    "]))],function(l,n){var e=n.component;l(n,3,0,l(n,4,0,!0));l(n,18,0,0==e.isOK);l(n,21,0,null!=e.numeroActual)},function(l,n){l(n,12,0,n.component.numeroActual)})}function d(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,8,"ion-header",[],null,null,null,null,null)),s["ɵdid"](1,16384,null,0,_.a,[S.a,s.ElementRef,s.Renderer,[2,j.a]],null,null),(l()(),s["ɵted"](-1,null,["\n    "])),(l()(),s["ɵeld"](3,0,null,null,1,"toolbar",[["btnBack","true"],["title","Mi Turno"]],null,[[null,"onBack"]],function(l,n,e){var t=!0;if("onBack"===n){t=!1!==l.component.close()&&t}return t},M.b,M.a)),s["ɵdid"](4,638976,null,0,P.a,[B.a,K.a,z.k,G.a,Z.a,U.a,Y.a,q.a,h.a,H.a,X.a,Q.a,$.a,ll.a,nl.a,el.a,tl.a,ul.a,il.a,ol.a,rl.a],{title:[0,"title"],btnBack:[1,"btnBack"]},{onBack:"onBack"}),(l()(),s["ɵted"](-1,null,["\n    "])),(l()(),s["ɵand"](16777216,null,null,1,null,t)),s["ɵdid"](7,16384,null,0,W.l,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](-1,null,["\n"])),(l()(),s["ɵted"](-1,null,["\n\n"])),(l()(),s["ɵeld"](10,0,null,null,8,"ion-content",[],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,al.b,al.a)),s["ɵdid"](11,4374528,null,0,dl.a,[S.a,U.a,sl.a,s.ElementRef,s.Renderer,Q.a,cl.a,s.NgZone,[2,j.a],[2,hl.a]],null,null),(l()(),s["ɵted"](-1,1,["\n    "])),(l()(),s["ɵand"](16777216,null,1,1,null,i)),s["ɵdid"](14,16384,null,0,W.l,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](-1,1,["\n    "])),(l()(),s["ɵand"](16777216,null,1,1,null,a)),s["ɵdid"](17,16384,null,0,W.l,[s.ViewContainerRef,s.TemplateRef],{ngIf:[0,"ngIf"]},null),(l()(),s["ɵted"](-1,1,["\n"])),(l()(),s["ɵted"](-1,null,["\n"]))],function(l,n){var e=n.component;l(n,4,0,"Mi Turno","true");l(n,7,0,null!=e.data);l(n,14,0,null!=e.data&&null===e.numeroActual);l(n,17,0,null!=e.numeroActual)},function(l,n){l(n,10,0,s["ɵnov"](n,11).statusbarPadding,s["ɵnov"](n,11)._hasRefresher)})}Object.defineProperty(n,"__esModule",{value:!0});var s=e(0),c=(e(1),e(11),e(16)),h=e(10),f=(e(66),e(213)),p=e(205),m=e(214),v=this&&this.__awaiter||function(l,n,e,t){return new(e||(e=Promise))(function(u,i){function o(l){try{a(t.next(l))}catch(l){i(l)}}function r(l){try{a(t.throw(l))}catch(l){i(l)}}function a(l){l.done?u(l.value):new e(function(n){n(l.value)}).then(o,r)}a((t=t.apply(l,n||[])).next())})},g=this&&this.__generator||function(l,n){function e(e){return function(o){return function(e){if(t)throw new TypeError("Generator is already executing.");for(;r;)try{if(t=1,u&&(i=u[2&e[0]?"return":e[0]?"throw":"next"])&&!(i=i.call(u,e[1])).done)return i;switch(u=0,i&&(e=[0,i.value]),e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++,u=e[1],e=[0];continue;case 7:e=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(6===e[0]||2===e[0])){r=0;continue}if(3===e[0]&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(6===e[0]&&r.label<i[1]){r.label=i[1],i=e;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(e);break}i[2]&&r.ops.pop(),r.trys.pop();continue}e=n.call(l,r)}catch(l){e=[6,l],u=0}finally{t=i=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,o])}}var t,u,i,o,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},b=function(){function l(l,n,e,t,u,i,o,r,a,d,s,c,h){var f=this;this.navCtrl=l,this.analytics=n,this.viewCtrl=e,this.navParams=t,this.http=u,this.config=i,this.loadingCtrl=o,this.event=r,this.localNotifications=a,this.vibration=d,this.alertCtrl=s,this.rowpersistence=c,this.platform=h,this.idFila="",this.urlEndPoint="",this.urlGetNumero="",this.numeroActual=null,this.isOK=!1,this.estadoActivo=!0,this.data=void 0,this.miTurnEnd=null,this.idFila=t.get("idFila"),void 0==this.idFila&&(this.idFila="315"),console.log(this.idFila);var p=this.config.getValue("STORE_KEYS");this.urlEndPoint=p.miTurnoDetalle,this.urlGetNumero=p.muTurnoNumero,h.registerBackButtonAction(function(){try{f.close()}catch(l){f.close()}},10)}return l.prototype.saveState=function(l){return v(this,void 0,void 0,function(){return g(this,function(n){return this.rowpersistence.setRow(this.idFila,l),[2]})})},l.prototype.checkState=function(){return v(this,void 0,void 0,function(){var l;return g(this,function(n){switch(n.label){case 0:return[4,this.rowpersistence.getRow()];case 1:return l=n.sent(),console.log("turn"),console.log(l),null!=l&&l.row===this.idFila&&(this.miTurnEnd=!1,this.numeroActual=l.turn),this.hideLoadingAlert(),[2]}})})},l.prototype.cleanState=function(){return v(this,void 0,void 0,function(){return g(this,function(l){return this.rowpersistence.clear(),this.hideLoadingAlert(),[2]})})},l.prototype.myTurnAlert=function(){return v(this,void 0,void 0,function(){var l,n,e,t,u=this;return g(this,function(i){return this.miTurnEnd||(this.miTurnEnd=!0,l=Math.floor(1e3*Math.random()),this.localNotifications.schedule({id:l,text:e="¿Fuiste atentido?. De lo contrario solicita otro ticket",title:n="Ya es tu turno"}),(t=this.alertCtrl.create({title:n,message:e,buttons:[{text:"Entendido",handler:function(){u.cleanState(),t.dismiss()}}]})).present(),this.vibration.vibrate([1e3,1e3,1e3])),[2]})})},l.prototype.delay=function(l){return new Promise(function(n){return setTimeout(n,l)})},l.prototype.updateData=function(){return v(this,void 0,void 0,function(){return g(this,function(l){switch(l.label){case 0:return this.estadoActivo?[4,this.getData()]:[3,3];case 1:return l.sent(),this.hideLoadingAlert(),[4,this.delay(6e3)];case 2:return l.sent(),[3,0];case 3:return[2]}})})},l.prototype.getData=function(){return v(this,void 0,void 0,function(){var l,n;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),(l=new c.a(this.urlEndPoint+this.idFila+"?_format=json","GET")).addHeader("Authorization","Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxNTA5NiIsIm5hbWUiOiJTb2RpbWFjIiwiYWRtaW4iOnRydWV9.7VC7h-JaOIE1s70MsFjheZcZNox8LjpwdwcERoge6kw"),[4,this.http.makeCall(l)];case 1:return null!=(n=e.sent())&&void 0!=n&&(this.data=n,console.log(this.data),null!=this.numeroActual&&this.numeroActual<=this.data.numero&&(this.myTurnAlert(),this.hideLoadingAlert())),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}})})},l.prototype.obtenerNumero=function(){return v(this,void 0,void 0,function(){var l,n;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.showLoadingAlert(),console.log(this.urlEndPoint),(l=new c.a(this.urlGetNumero+this.idFila+"&cliente=null","POST")).addHeader("Authorization","Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxNTA5NiIsIm5hbWUiOiJTb2RpbWFjIiwiYWRtaW4iOnRydWV9.7VC7h-JaOIE1s70MsFjheZcZNox8LjpwdwcERoge6kw"),[4,this.http.makeCall(l)];case 1:return n=e.sent(),this.hideLoadingAlert(),console.log("ObtenerNumero"),console.log(n),this.miTurnEnd=!1,this.numeroActual=n.turno,this.saveState(n.turno),this.hideLoadingAlert(),[3,3];case 2:return e.sent(),this.hideLoadingAlert(),[3,3];case 3:return[2]}})})},l.prototype.calcTime=function(l){try{if(0===l.tee)return"0";var n=(l.tee/60).toString();return n=n.length>2?(l.tee/60).toString().substring(0,2):(l.tee/60).toString(),n=n.replace(".","")}catch(l){return 0}},l.prototype.showLoadingAlert=function(){this.loadingController=this.loadingCtrl.create({content:"Obteniendo Nº...",spinner:"dots",duration:5e3}),this.loadingController.present()},l.prototype.hideLoadingAlert=function(){try{this.loadingController.dismiss()}catch(l){}},l.prototype.cancelarNumero=function(){try{this.miTurnEnd=null,this.numeroActual=null,this.isOK=!1,this.cleanState(),this.estadoActivo=!1,this.hideLoadingAlert()}catch(l){}},l.prototype.ionViewDidLoad=function(){this.analytics.trackView("Mi Turno Detalle"),this.updateData(),this.checkState()},l.prototype.ionViewWillLeave=function(){console.log("ionViewWillLeave"),this.estadoActivo=!1},l.prototype.close=function(){var l=this;try{if(!0===this.miTurnEnd){this.alertCtrl.create({title:"Mi Turno",message:"¿Esta seguro que quiere volver?",buttons:[{text:"Volver",handler:function(){return l.viewCtrl.dismiss(),l.estadoActivo=!1,!0}},{text:"Cancelar",handler:function(){return!0}}]}).present()}else this.viewCtrl.dismiss()}catch(l){console.log("Err on back -> ",l),this.navCtrl.pop()}},l}(),y=e(187),w=function(){return function(){}}(),R=e(278),I=e(279),A=e(280),T=e(281),C=e(282),k=e(283),E=e(284),O=e(285),N=e(286),L=e(136),V=e(134),F=e(135),D=e(30),S=e(2),W=e(13),x=e(32),J=e(21),_=e(129),j=e(5),M=e(290),P=e(132),B=e(27),K=e(48),z=e(23),G=e(67),Z=e(70),U=e(4),Y=e(90),q=e(87),H=e(56),X=e(55),Q=e(8),$=e(69),ll=e(57),nl=e(47),el=e(88),tl=e(68),ul=e(89),il=e(36),ol=e(33),rl=e(91),al=e(287),dl=e(29),sl=e(9),cl=e(31),hl=e(24),fl=e(15),pl=e(62),ml=e(140),vl=s["ɵcrt"]({encapsulation:2,styles:[],data:{}}),gl=s["ɵccf"]("page-mi-turno-detalle",b,function(l){return s["ɵvid"](0,[(l()(),s["ɵeld"](0,0,null,null,1,"page-mi-turno-detalle",[],null,null,null,d,vl)),s["ɵdid"](1,49152,null,0,b,[hl.a,nl.a,j.a,fl.a,pl.a,h.a,ml.a,X.a,f.a,p.a,ll.a,m.a,U.a],null,null)],null,null)},{},{},[]),bl=e(17),yl=e(188),wl=e(128),Rl=e(54);e.d(n,"MiTurnoDetallePageModuleNgFactory",function(){return Il});var Il=s["ɵcmf"](w,[],function(l){return s["ɵmod"]([s["ɵmpd"](512,s.ComponentFactoryResolver,s["ɵCodegenComponentFactoryResolver"],[[8,[R.a,I.a,A.a,T.a,C.a,k.a,E.a,O.a,N.a,gl]],[3,s.ComponentFactoryResolver],s.NgModuleRef]),s["ɵmpd"](4608,W.n,W.m,[s.LOCALE_ID,[2,W.z]]),s["ɵmpd"](4608,bl.n,bl.n,[]),s["ɵmpd"](4608,bl.c,bl.c,[]),s["ɵmpd"](4608,W.c,W.c,[s.LOCALE_ID]),s["ɵmpd"](512,W.b,W.b,[]),s["ɵmpd"](512,bl.l,bl.l,[]),s["ɵmpd"](512,bl.d,bl.d,[]),s["ɵmpd"](512,bl.k,bl.k,[]),s["ɵmpd"](512,yl.a,yl.a,[]),s["ɵmpd"](512,yl.b,yl.b,[]),s["ɵmpd"](512,z.h,z.h,[]),s["ɵmpd"](512,wl.a,wl.a,[]),s["ɵmpd"](512,y.a,y.a,[]),s["ɵmpd"](512,w,w,[]),s["ɵmpd"](256,Rl.a,b,[])])})}});